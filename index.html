<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>蘑菇森林</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- 玻璃拟态导航栏 -->
    <nav class="glass-nav">
        <div class="nav-logo">蘑菇森林</div>
        <ul class="nav-links">
            <li><a href="#">首页</a></li>
            <li><a href="#blog">蘑菇札记</a></li>
            <li><a href="#monthly">蘑菇月月记</a></li>
            <li><a href="#gallery">森林宝藏</a></li>
        </ul>
    </nav>

    <!-- 头部区域 -->
    <header>
        <div class="forest-bg"></div>
        <div class="tree tree-1"></div>
        <div class="tree tree-2"></div>
        <div class="tree tree-3"></div>
        <div class="tree tree-4"></div>
        
        <div class="mushroom" id="mushroom">
            <div class="mushroom-cap"></div>
            <div class="mushroom-stem"></div>
        </div>
        
        <div class="header-content">
            <h1 class="site-title">Welcome to Mushroom's World !</h1>
            <p class="site-subtitle">蘑菇碎碎念 & 一些小小日常</p>
            <a href="#main-content" class="explore-btn" id="exploreBtn">进入探索</a>
        </div>
        
        <div class="scroll-down">
            <i class="fas fa-chevron-down"></i>
        </div>
    </header>

    <!-- 主要内容区域 -->
    <div class="container" id="main-content">
        <!-- 左侧边栏 -->
        <aside class="sidebar">
            <!-- 个人介绍框 -->
            <div class="sidebar-box user-section">
                <div class="avatar-container">
                    <div class="sidebar-mushroom-avatar">
                        <div class="sidebar-mushroom-cap"></div>
                        <div class="sidebar-mushroom-stem"></div>
                    </div>
                </div>
                <h2 class="user-name">蘑菇大王</h2>
                <p class="user-bio">嗨嗨~家人们，欢迎来到蘑菇的自言自语最高心事秘密战略基地！</p>
                
                <!-- 个人介绍下方的分隔线 -->
                <div class="bio-divider"></div>
                
                <!-- 统计信息区域 -->
                <div class="stats-section">
                    <div class="stat-item">
                        <span class="stat-label">博客</span>
                        <span class="stat-number">3</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">瞬间</span>
                        <span class="stat-number">5</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">互动</span>
                        <span class="stat-number">3</span>
                    </div>
                </div>
            </div>

            <!-- 蘑菇市心情预报 -->
            <div class="sidebar-box weather-forecast">
                <h3 class="weather-title">蘑菇市心情预报</h3>
                <div class="weather-content">
                    <div class="current-weather">
                        <div class="weather-icon">
                            <i class="fas fa-sun"></i>
                        </div>
                        <div class="weather-info">
                            <div class="temperature">25°C</div>
                            <div class="weather-desc">晴朗</div>
                        </div>
                    </div>
                    <div class="weather-details">
                        <div class="detail-item">
                            <span class="detail-label">湿度</span>
                            <span class="detail-value">65%</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">心情指数</span>
                            <span class="detail-value">89/100</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">今日建议</span>
                            <span class="detail-value">适合户外散步</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 留言板 -->
            <div class="sidebar-box message-board">
                <h3 class="message-title">留言板</h3>
                <div class="message-content">
                    <div class="message-list">
                        <div class="message-item">
                            <div class="message-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="message-text">
                                <div class="message-author">小蘑菇</div>
                                <div class="message-body">今天天气真好，适合去森林散步！</div>
                                <div class="message-time">10分钟前</div>
                            </div>
                        </div>
                        <div class="message-item">
                            <div class="message-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="message-text">
                                <div class="message-author">森林守护者</div>
                                <div class="message-body">发现了一朵特别漂亮的蘑菇！</div>
                                <div class="message-time">1小时前</div>
                            </div>
                        </div>
                    </div>
                    <div class="message-input">
                        <textarea placeholder="写下你的留言..."></textarea>
                        <button class="send-btn">发送</button>
                    </div>
                </div>
            </div>
        </aside>

        <!-- 主内容区 -->
        <main class="main-content">
            <!-- 蘑菇札记部分 -->
            <section id="blog">
                <h2 class="section-title">蘑菇札记</h2>
                <div class="blog-posts">
                    <!-- 博客文章1 -->
                    <article class="blog-post" data-id="1">
                        <div class="post-image-container">
                            <div class="post-carousel">
                                <div class="carousel-slides">
                                    <div class="carousel-slide active" style="background-image: url('images/glj 1.jpg')"></div>
                                    <div class="carousel-slide" style="background-image: url('images/glj 2.jpg')"></div>
                                    <div class="carousel-slide" style="background-image: url('images/glj 3.jpg')"></div>
                                    <div class="carousel-slide" style="background-image: url('images/glj 4.jpg')"></div>
                                </div>
                                <!-- 指示器 -->
                                <div class="carousel-indicators">
                                    <span class="indicator active" data-index="0"></span>
                                    <span class="indicator" data-index="1"></span>
                                    <span class="indicator" data-index="2"></span>
                                    <span class="indicator" data-index="3"></span>
                                </div>
                            </div>
                        </div>
                        <div class="post-content">
                            <h3 class="post-title">🍄蘑菇好友记·小谷同志</h3>
                            <div class="post-meta">
                                <span><i class="far fa-calendar"></i> 2025年8月9日</span>
                                <span><i class="far fa-comment"></i> 2条评论</span>
                            </div>
                            <p class="post-excerpt">和特别合拍的朋友见面，是生命能量特殊的快充方式！</p>
                            <a href="#" class="read-more">阅读更多 <i class="fas fa-arrow-right"></i></a>
                        </div>
                    </article>
                    
                    <!-- 博客文章2 -->
                    <article class="blog-post" data-id="2">
                        <div class="post-image-container">
                            <div class="post-carousel">
                                <div class="carousel-slides">
                                    <div class="carousel-slide active" style="background-image: url('images/dm 5.jpg')"></div>
                                    <div class="carousel-slide" style="background-image: url('images/dm 4.jpg')"></div>
                                    <div class="carousel-slide" style="background-image: url('images/dm 3.jpg')"></div>
                                    <div class="carousel-slide" style="background-image: url('images/dm 2.jpg')"></div>
                                </div>
                                <!-- 指示器 -->
                                <div class="carousel-indicators">
                                    <span class="indicator active" data-index="0"></span>
                                    <span class="indicator" data-index="1"></span>
                                    <span class="indicator" data-index="2"></span>
                                    <span class="indicator" data-index="3"></span>
                                </div>
                            </div>
                        </div>
                        <div class="post-content">
                            <h3 class="post-title">傍晚六点半</h3>
                            <div class="post-meta">
                                <span><i class="far fa-calendar"></i> 2025年8月29日</span>
                                <span><i class="far fa-comment"></i> 2条评论</span>
                            </div>
                            <p class="post-excerpt">希望我们永远拥有傍晚六点半的自由和浪漫</p>
                            <a href="#" class="read-more">阅读更多 <i class="fas fa-arrow-right"></i></a>
                        </div>
                    </article>
                    
                    <!-- 博客文章3 -->
                    <article class="blog-post" data-id="3">
                        <div class="post-image-container">
                            <div class="post-carousel">
                                <div class="carousel-slides">
                                    <div class="carousel-slide active" style="background-image: url('images/lr 4.jpg')"></div>
                                    <div class="carousel-slide" style="background-image: url('images/lr 3.jpg')"></div>
                                    <div class="carousel-slide" style="background-image: url('images/lr 1.jpg')"></div>
                                    <div class="carousel-slide" style="background-image: url('images/lr 5.jpg')"></div>
                                </div>
                                <!-- 指示器 -->
                                <div class="carousel-indicators">
                                    <span class="indicator active" data-index="0"></span>
                                    <span class="indicator" data-index="1"></span>
                                    <span class="indicator" data-index="2"></span>
                                    <span class="indicator" data-index="3"></span>
                                </div>
                            </div>
                        </div>
                        <div class="post-content">
                            <h3 class="post-title">日落时分</h3>
                            <div class="post-meta">
                                <span><i class="far fa-calendar"></i> 2025年8月30日</span>
                                <span><i class="far fa-comment"></i> 1条评论</span>
                            </div>
                            <p class="post-excerpt">"我的一生中有无数个日落。日落前的50分钟里，太阳与地面的夹角由6°移动到-4°，留下镀上金红色的、柔焦的世界。他们叫它'GoldenHour'，而我喜欢叫另一个名字——'流金时刻'。"</p>
                            <a href="#" class="read-more">阅读更多 <i class="fas fa-arrow-right"></i></a>
                        </div>
                    </article>
                </div>
            </section>
            
            <!-- 蘑菇月月记部分 -->
            <section id="monthly">
                <h2 class="section-title">蘑菇月月记</h2>
                <div class="monthly-calendar">
                    <div class="calendar-header">
                        <button class="calendar-nav prev-month"><i class="fas fa-chevron-left"></i></button>
                        <h3 class="calendar-title">2023年10月</h3>
                        <button class="calendar-nav next-month"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <div class="calendar-weekdays">
                        <div class="weekday">日</div>
                        <div class="weekday">一</div>
                        <div class="weekday">二</div>
                        <div class="weekday">三</div>
                        <div class="weekday">四</div>
                        <div class="weekday">五</div>
                        <div class="weekday">六</div>
                    </div>
                    <div class="calendar-days">
                        <!-- 日历日期将通过JavaScript动态生成 -->
                    </div>
                    
                    <!-- 权限控制区域 - 简单棕色按钮 -->
                    <div class="permission-control">
                        <button class="permission-btn" id="editToggle">
                            <i class="fas fa-edit"></i> 作者登录
                        </button>
                    </div>
                </div>
                
                <!-- 日历贴纸背景 -->
                <div class="calendar-stickers">
                    <div class="sticker sticker-pinecone"></div>
                    <div class="sticker sticker-mushroom"></div>
                    <div class="sticker sticker-leaf"></div>
                </div>
            </section>
            
            <!-- 森林宝藏部分 -->
            <section id="gallery">
                <h2 class="section-title">森林宝藏</h2>
                <div class="gallery-carousel">
                    <div class="carousel-container">
                        <div class="carousel-track">
                            <div class="carousel-slide active" data-index="0">
                                <div class="slide-image" style="background-image: url('images/dm\ 3.jpg')"></div>
                                <div class="slide-content">
                                    <h3>傍晚六点半</h3>
                                    <p>分分秒秒都精彩 就这样沦陷在人海</p>
                                </div>
                            </div>
                            <div class="carousel-slide" data-index="1">
                                <div class="slide-image" style="background-image: url('images/dm\ 6.jpg')"></div>
                                <div class="slide-content">
                                    <h3>傍晚六点半</h3>
                                    <p>分分秒秒都精彩 就这样沦陷在人海</p>
                                </div>
                            </div>
                            <div class="carousel-slide" data-index="2">
                                <div class="slide-image" style="background-image: url('images/xd\ 11.jpg')"></div>
                                <div class="slide-content">
                                    <h3>小岛夏天</h3>
                                    <p>就这样，在路上</p>
                                </div>
                            </div>
                            <div class="carousel-slide" data-index="3">
                                <div class="slide-image" style="background-image: url('images/lr\ 4.jpg')"></div>
                                <div class="slide-content">
                                    <h3>日落时分</h3>
                                    <p>"落日溺于橘子海，晚风陷于赤诚爱"</p>
                                </div>
                            </div>
                            <div class="carousel-slide" data-index="4">
                                <div class="slide-image" style="background-image: url('images/xd\ 12.jpg')"></div>
                                <div class="slide-content">
                                    <h3>小岛夏天</h3>
                                    <p>去一个小岛，一个晨昏难辨的岛屿</p>
                                </div>
                            </div>
                            <div class="carousel-slide" data-index="5">
                                <div class="slide-image" style="background-image: url('images/xd\ 6.jpg')"></div>
                                <div class="slide-content">
                                    <h3>灯塔</h3>
                                    <p>"爱是亘古长明的灯塔"————泰戈尔</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 指示器 -->
                        <div class="carousel-indicators">
                            <span class="indicator active" data-index="0"></span>
                            <span class="indicator" data-index="1"></span>
                            <span class="indicator" data-index="2"></span>
                            <span class="indicator" data-index="3"></span>
                            <span class="indicator" data-index="4"></span>
                            <span class="indicator" data-index="5"></span>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- 页脚 -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>最后的最后</h3>
                <p>蘑菇森林🍄 泡泡世界🌏</p>
                <p>这个世界没有"大人"！在这里无所畏惧</p>
                <p>请抓住每一瞬间，凭感觉，找到身体里的小小自己</p>
                <p>感谢倾听蘑菇的生活碎碎念！</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-weibo"></i></a>
                    <a href="#"><i class="fab fa-weixin"></i></a>
                    <a href="#"><i class="fab fa-github"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            
            <div class="footer-section">
                <h3>快速链接</h3>
                <ul class="footer-links">
                    <li><a href="#">首页</a></li>
                    <li><a href="#blog">蘑菇札记</a></li>
                    <li><a href="#monthly">蘑菇月月记</a></li>
                    <li><a href="#gallery">森林宝藏</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>Call Me！！！</h3>
                <ul class="footer-links">
                    <li><i class="fas fa-envelope"></i> contact@mushroomforest.com</li>
                    <li><i class="fas fa-phone"></i> +86 138 0013 8000</li>
                    <li><i class="fas fa-map-marker-alt"></i> 中国 · 宁波</li>
                </ul>
            </div>
        </div>
        
        <div class="copyright">
            <p>&copy; 2023 蘑菇森林个人博客 | 探索自然之美，记录生活点滴</p>
        </div>
    </footer>

    <!-- 蘑菇札记图片放大模态框 -->
    <div id="blogModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="modal-carousel">
                <div class="modal-slides">
                    <!-- 动态添加图片 -->
                </div>
                <button class="modal-nav modal-prev">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="modal-nav modal-next">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- 森林宝藏图片放大模态框 -->
    <div id="galleryModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="modal-carousel">
                <div class="modal-slides">
                    <!-- 动态添加图片 -->
                </div>
                <button class="modal-nav modal-prev">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="modal-nav modal-next">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript代码 -->
    <script>
        // 蘑菇发光效果
        const exploreBtn = document.getElementById('exploreBtn');
        const mushroom = document.getElementById('mushroom');
        
        // 添加点击事件监听器
        exploreBtn.addEventListener('click', function() {
            mushroom.classList.toggle('bright');
        });
        
        // 添加鼠标悬停事件监听器
        exploreBtn.addEventListener('mouseenter', function() {
            mushroom.classList.add('bright');
        });
        
        exploreBtn.addEventListener('mouseleave', function() {
            mushroom.classList.remove('bright');
        });
        
        // 留言板功能
        const sendBtn = document.querySelector('.send-btn');
        const messageInput = document.querySelector('.message-input textarea');
        const messageList = document.querySelector('.message-list');
        
        sendBtn.addEventListener('click', function() {
            const messageText = messageInput.value.trim();
            if (messageText) {
                const newMessage = document.createElement('div');
                newMessage.className = 'message-item';
                newMessage.innerHTML = `
                    <div class="message-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="message-text">
                        <div class="message-author">游客</div>
                        <div class="message-body">${messageText}</div>
                        <div class="message-time">刚刚</div>
                    </div>
                `;
                messageList.prepend(newMessage);
                messageInput.value = '';
            }
        });
        
        // 日历功能
        function generateCalendar(year, month) {
            const calendarDays = document.querySelector('.calendar-days');
            calendarDays.innerHTML = '';
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay();
            
            // 添加上个月的日期
            const prevMonthLastDay = new Date(year, month, 0).getDate();
            for (let i = startingDay - 1; i >= 0; i--) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day other-month';
                dayElement.textContent = prevMonthLastDay - i;
                calendarDays.appendChild(dayElement);
            }
            
            // 添加当前月的日期
            for (let i = 1; i <= daysInMonth; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = i;
                
                // 为特定日期添加事件标记
                if (i === 5 || i === 12 || i === 19 || i === 26) {
                    const eventMarker = document.createElement('div');
                    eventMarker.className = 'event-marker';
                    dayElement.appendChild(eventMarker);
                }
                
                calendarDays.appendChild(dayElement);
            }
            
            // 添加下个月的日期
            const totalCells = 42; // 6行x7列
            const remainingCells = totalCells - (startingDay + daysInMonth);
            for (let i = 1; i <= remainingCells; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day other-month';
                dayElement.textContent = i;
                calendarDays.appendChild(dayElement);
            }
        }
        
        // 初始化日历
        let currentDate = new Date();
        generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
        
        // 更新日历标题
        const monthNames = ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"];
        document.querySelector('.calendar-title').textContent = `${currentDate.getFullYear()}年${monthNames[currentDate.getMonth()]}`;
        
        // 月份导航
        document.querySelector('.prev-month').addEventListener('click', function() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
            document.querySelector('.calendar-title').textContent = `${currentDate.getFullYear()}年${monthNames[currentDate.getMonth()]}`;
        });
        
        document.querySelector('.next-month').addEventListener('click', function() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
            document.querySelector('.calendar-title').textContent = `${currentDate.getFullYear()}年${monthNames[currentDate.getMonth()]}`;
        });
        
        // 权限控制功能
        const editToggle = document.getElementById('editToggle');
        let isAuthorMode = false;
        
        // 作者登录功能
        editToggle.addEventListener('click', function() {
            if (!isAuthorMode) {
                const password = prompt('请输入作者密码：');
                // 简单密码验证，实际应用中应该使用更安全的方式
                if (password === 'mogu2023') {
                    isAuthorMode = true;
                    editToggle.innerHTML = '<i class="fas fa-times"></i> 退出编辑';
                    editToggle.classList.add('active');
                    enableEditing();
                    showNotification('已切换到作者模式，现在可以编辑日历内容。', 'success');
                } else {
                    showNotification('密码错误，无法切换到作者模式。', 'error');
                }
            } else {
                isAuthorMode = false;
                editToggle.innerHTML = '<i class="fas fa-edit"></i> 作者登录';
                editToggle.classList.remove('active');
                disableEditing();
                showNotification('已退出作者模式，现在是访客模式。', 'info');
            }
        });
        
        // 启用编辑功能
        function enableEditing() {
            const calendarDays = document.querySelectorAll('.calendar-day');
            calendarDays.forEach(day => {
                if (!day.classList.contains('other-month')) {
                    day.setAttribute('contenteditable', 'true');
                    day.classList.add('editable');
                    
                    // 添加输入事件监听器，实时保存内容
                    day.addEventListener('input', function() {
                        saveCalendarData();
                    });
                }
            });
            
            // 添加双击添加事件标记的功能
            calendarDays.forEach(day => {
                if (!day.classList.contains('other-month')) {
                    day.addEventListener('dblclick', function() {
                        if (isAuthorMode) {
                            const eventMarker = document.createElement('div');
                            eventMarker.className = 'event-marker';
                            this.appendChild(eventMarker);
                            saveCalendarData(); // 保存事件标记
                        }
                    });
                }
            });
        }
        
        // 禁用编辑功能
        function disableEditing() {
            const calendarDays = document.querySelectorAll('.calendar-day');
            calendarDays.forEach(day => {
                day.setAttribute('contenteditable', 'false');
                day.classList.remove('editable');
                
                // 移除输入事件监听器
                day.removeEventListener('input', saveCalendarData);
            });
        }
        
        // 保存日历数据到localStorage
        function saveCalendarData() {
            const calendarData = {};
            const calendarDays = document.querySelectorAll('.calendar-day');
            
            calendarDays.forEach((day, index) => {
                if (!day.classList.contains('other-month')) {
                    // 获取日期内容
                    const content = day.textContent.replace(/\n/g, '').trim();
                    
                    // 检查是否有事件标记
                    const hasEvent = day.querySelector('.event-marker') !== null;
                    
                    // 保存数据
                    calendarData[index] = {
                        content: content,
                        hasEvent: hasEvent
                    };
                }
            });
            
            // 保存到localStorage
            localStorage.setItem('mushroomCalendarData', JSON.stringify(calendarData));
        }
        
        // 从localStorage加载日历数据
        function loadCalendarData() {
            const savedData = localStorage.getItem('mushroomCalendarData');
            if (savedData) {
                const calendarData = JSON.parse(savedData);
                const calendarDays = document.querySelectorAll('.calendar-day');
                
                calendarDays.forEach((day, index) => {
                    if (!day.classList.contains('other-month') && calendarData[index]) {
                        // 恢复内容
                        day.textContent = calendarData[index].content;
                        
                        // 恢复事件标记
                        if (calendarData[index].hasEvent) {
                            const eventMarker = document.createElement('div');
                            eventMarker.className = 'event-marker';
                            day.appendChild(eventMarker);
                        }
                    }
                });
            }
        }
        
        // 显示通知
        function showNotification(message, type) {
            // 创建通知元素
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            // 添加到页面
            document.body.appendChild(notification);
            
            // 显示通知
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            // 自动隐藏
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
        
        // 页面加载时从localStorage恢复数据
        document.addEventListener('DOMContentLoaded', function() {
            loadCalendarData();
        });
        
        // 蘑菇札记自动轮播功能
        document.addEventListener('DOMContentLoaded', function() {
            const blogPosts = document.querySelectorAll('.blog-post');
            
            blogPosts.forEach(post => {
                const carouselSlides = post.querySelectorAll('.carousel-slide');
                const indicators = post.querySelectorAll('.indicator');
                
                let currentIndex = 0;
                let autoPlayInterval;
                const slideCount = carouselSlides.length;
                
                // 预加载所有图片，确保轮播平滑
                function preloadImages() {
                    carouselSlides.forEach(slide => {
                        const img = new Image();
                        img.src = slide.style.backgroundImage.replace(/url\(['"]?(.*?)['"]?\)/i, '$1');
                        img.onload = function() {
                            // 图片加载完成后，确保轮播容器有正确的背景色
                            slide.style.backgroundColor = 'transparent';
                        };
                    });
                }
                
                // 初始化轮播
                function initCarousel() {
                    preloadImages();
                    updateCarousel();
                    startAutoPlay();
                }
                
                // 更新轮播显示
                function updateCarousel() {
                    carouselSlides.forEach((slide, index) => {
                        slide.classList.remove('active');
                        if (index === currentIndex) {
                            slide.classList.add('active');
                        }
                    });
                    
                    indicators.forEach((indicator, index) => {
                        indicator.classList.remove('active');
                        if (index === currentIndex) {
                            indicator.classList.add('active');
                        }
                    });
                }
                
                // 切换到下一张
                function nextSlide() {
                    currentIndex = (currentIndex + 1) % slideCount;
                    updateCarousel();
                }
                
                // 开始自动播放
                function startAutoPlay() {
                    autoPlayInterval = setInterval(nextSlide, 4000); // 4秒切换一次
                }
                
                // 停止自动播放
                function stopAutoPlay() {
                    clearInterval(autoPlayInterval);
                }
                
                // 重置自动播放
                function resetAutoPlay() {
                    stopAutoPlay();
                    startAutoPlay();
                }
                
                // 指示器点击事件
                indicators.forEach((indicator, index) => {
                    indicator.addEventListener('click', function() {
                        currentIndex = index;
                        updateCarousel();
                        resetAutoPlay();
                    });
                });
                
                // 鼠标悬停时暂停自动播放
                post.addEventListener('mouseenter', stopAutoPlay);
                post.addEventListener('mouseleave', startAutoPlay);
                
                // 初始化轮播
                initCarousel();
            });
        });

        // 森林宝藏轮播功能
        document.addEventListener('DOMContentLoaded', function() {
            const carouselTrack = document.querySelector('.carousel-track');
            const slides = document.querySelectorAll('.carousel-slide');
            const indicators = document.querySelectorAll('.carousel-indicators .indicator');
            
            let currentIndex = 0;
            let autoPlayInterval;
            const slideCount = slides.length;
            
            // 预加载所有图片，确保轮播平滑
            function preloadImages() {
                slides.forEach(slide => {
                    const img = new Image();
                    img.src = slide.querySelector('.slide-image').style.backgroundImage.replace(/url\(['"]?(.*?)['"]?\)/i, '$1');
                    img.onload = function() {
                        // 图片加载完成后，确保轮播容器有正确的背景色
                        slide.style.backgroundColor = 'transparent';
                    };
                });
            }
            
            // 初始化轮播
            function initCarousel() {
                preloadImages();
                updateCarousel();
                startAutoPlay();
            }
            
            // 更新轮播显示
            function updateCarousel() {
                slides.forEach((slide, index) => {
                    slide.classList.remove('active');
                    if (index === currentIndex) {
                        slide.classList.add('active');
                    }
                });
                
                indicators.forEach((indicator, index) => {
                    indicator.classList.remove('active');
                    if (index === currentIndex) {
                        indicator.classList.add('active');
                    }
                });
            }
            
            // 切换到下一张
            function nextSlide() {
                currentIndex = (currentIndex + 1) % slideCount;
                updateCarousel();
            }
            
            // 开始自动播放
            function startAutoPlay() {
                autoPlayInterval = setInterval(nextSlide, 4000); // 4秒切换一次
            }
            
            // 停止自动播放
            function stopAutoPlay() {
                clearInterval(autoPlayInterval);
            }
            
            // 重置自动播放
            function resetAutoPlay() {
                stopAutoPlay();
                startAutoPlay();
            }
            
            // 指示器点击事件
            indicators.forEach((indicator, index) => {
                indicator.addEventListener('click', function() {
                    currentIndex = index;
                    updateCarousel();
                    resetAutoPlay();
                });
            });
            
            // 鼠标悬停时暂停自动播放
            const carouselContainer = document.querySelector('.carousel-container');
            carouselContainer.addEventListener('mouseenter', stopAutoPlay);
            carouselContainer.addEventListener('mouseleave', startAutoPlay);
            
            // 初始化轮播
            initCarousel();
        });

        // 蘑菇札记图片放大模态框功能
        const blogModal = document.getElementById('blogModal');
        const blogModalSlides = document.querySelector('#blogModal .modal-slides');
        const blogModalPrev = document.querySelector('#blogModal .modal-prev');
        const blogModalNext = document.querySelector('#blogModal .modal-next');
        const blogCloseBtn = document.querySelector('#blogModal .close');
        
        let blogModalCurrentIndex = 0;
        let blogModalSlidesCount = 0;
        let currentBlogPost = null;
        
        // 为每个博客文章的轮播图添加点击事件
        document.querySelectorAll('.blog-post').forEach(post => {
            const carouselSlides = post.querySelectorAll('.carousel-slide');
            
            carouselSlides.forEach((slide, index) => {
                slide.addEventListener('click', function() {
                    openBlogModal(post, index);
                });
            });
        });
        
        // 打开蘑菇札记模态框
        function openBlogModal(blogPost, startIndex) {
            currentBlogPost = blogPost;
            blogModalCurrentIndex = startIndex;
            blogModalSlides.innerHTML = '';
            
            // 获取当前文章的所有图片
            const carouselSlides = blogPost.querySelectorAll('.carousel-slide');
            blogModalSlidesCount = carouselSlides.length;
            
            // 创建模态框中的图片
            carouselSlides.forEach(slide => {
                const modalSlide = document.createElement('div');
                modalSlide.className = 'modal-slide';
                modalSlide.style.backgroundImage = slide.style.backgroundImage;
                blogModalSlides.appendChild(modalSlide);
            });
            
            // 显示模态框
            blogModal.style.display = 'block';
            updateBlogModal();
            
            // 停止所有蘑菇札记自动轮播
            document.querySelectorAll('.blog-post').forEach(post => {
                const carousel = post.querySelector('.post-carousel');
                if (carousel) {
                    const autoPlayInterval = carousel.getAttribute('data-interval');
                    if (autoPlayInterval) {
                        clearInterval(parseInt(autoPlayInterval));
                    }
                }
            });
        }
        
        // 更新蘑菇札记模态框显示
        function updateBlogModal() {
            const modalSlides = document.querySelectorAll('#blogModal .modal-slide');
            modalSlides.forEach((slide, index) => {
                slide.classList.remove('active');
                if (index === blogModalCurrentIndex) {
                    slide.classList.add('active');
                }
            });
        }
        
        // 蘑菇札记模态框下一张
        blogModalNext.addEventListener('click', function() {
            blogModalCurrentIndex = (blogModalCurrentIndex + 1) % blogModalSlidesCount;
            updateBlogModal();
        });
        
        // 蘑菇札记模态框上一张
        blogModalPrev.addEventListener('click', function() {
            blogModalCurrentIndex = (blogModalCurrentIndex - 1 + blogModalSlidesCount) % blogModalSlidesCount;
            updateBlogModal();
        });
        
        // 关闭蘑菇札记模态框
        blogCloseBtn.addEventListener('click', function() {
            blogModal.style.display = 'none';
            
            // 恢复蘑菇札记自动轮播
            document.querySelectorAll('.blog-post').forEach(post => {
                const carousel = post.querySelector('.post-carousel');
                if (carousel) {
                    startAutoPlayForBlogCarousel(carousel);
                }
            });
        });
        
        // 点击蘑菇札记模态框外部关闭
        window.addEventListener('click', function(event) {
            if (event.target === blogModal) {
                blogModal.style.display = 'none';
                
                // 恢复蘑菇札记自动轮播
                document.querySelectorAll('.blog-post').forEach(post => {
                    const carousel = post.querySelector('.post-carousel');
                    if (carousel) {
                        startAutoPlayForBlogCarousel(carousel);
                    }
                });
            }
        });
        
        // 为蘑菇札记轮播启动自动播放的函数
        function startAutoPlayForBlogCarousel(carousel) {
            const carouselSlides = carousel.querySelectorAll('.carousel-slide');
            const indicators = carousel.querySelectorAll('.indicator');
            let currentIndex = 0;
            const slideCount = carouselSlides.length;
            
            const interval = setInterval(() => {
                currentIndex = (currentIndex + 1) % slideCount;
                
                carouselSlides.forEach((slide, index) => {
                    slide.classList.remove('active');
                    if (index === currentIndex) {
                        slide.classList.add('active');
                    }
                });
                
                indicators.forEach((indicator, index) => {
                    indicator.classList.remove('active');
                    if (index === currentIndex) {
                        indicator.classList.add('active');
                    }
                });
            }, 4000);
            
            carousel.setAttribute('data-interval', interval);
        }

        // 森林宝藏图片放大模态框功能
        const galleryModal = document.getElementById('galleryModal');
        const galleryModalSlides = document.querySelector('#galleryModal .modal-slides');
        const galleryModalPrev = document.querySelector('#galleryModal .modal-prev');
        const galleryModalNext = document.querySelector('#galleryModal .modal-next');
        const galleryCloseBtn = document.querySelector('#galleryModal .close');
        
        let galleryModalCurrentIndex = 0;
        let galleryModalSlidesCount = 0;
        
        // 为森林宝藏的轮播图添加点击事件
        document.querySelectorAll('#gallery .carousel-slide').forEach(slide => {
            slide.addEventListener('click', function() {
                openGalleryModal(parseInt(this.getAttribute('data-index')));
            });
        });
        
        // 打开森林宝藏模态框
        function openGalleryModal(startIndex) {
            galleryModalCurrentIndex = startIndex;
            galleryModalSlides.innerHTML = '';
            
            // 获取所有森林宝藏图片
            const gallerySlides = document.querySelectorAll('#gallery .carousel-slide');
            galleryModalSlidesCount = gallerySlides.length;
            
            // 创建模态框中的图片
            gallerySlides.forEach(slide => {
                const modalSlide = document.createElement('div');
                modalSlide.className = 'modal-slide';
                modalSlide.style.backgroundImage = slide.querySelector('.slide-image').style.backgroundImage;
                
                // 复制标题和描述
                const slideContent = slide.querySelector('.slide-content').cloneNode(true);
                modalSlide.appendChild(slideContent);
                
                galleryModalSlides.appendChild(modalSlide);
            });
            
            // 显示模态框
            galleryModal.style.display = 'block';
            updateGalleryModal();
            
            // 停止森林宝藏自动轮播
            const carouselContainer = document.querySelector('.carousel-container');
            if (carouselContainer) {
                const autoPlayInterval = carouselContainer.getAttribute('data-interval');
                if (autoPlayInterval) {
                    clearInterval(parseInt(autoPlayInterval));
                }
            }
        }
        
        // 更新森林宝藏模态框显示
        function updateGalleryModal() {
            const modalSlides = document.querySelectorAll('#galleryModal .modal-slide');
            modalSlides.forEach((slide, index) => {
                slide.classList.remove('active');
                if (index === galleryModalCurrentIndex) {
                    slide.classList.add('active');
                }
            });
        }
        
        // 森林宝藏模态框下一张
        galleryModalNext.addEventListener('click', function() {
            galleryModalCurrentIndex = (galleryModalCurrentIndex + 1) % galleryModalSlidesCount;
            updateGalleryModal();
        });
        
        // 森林宝藏模态框上一张
        galleryModalPrev.addEventListener('click', function() {
            galleryModalCurrentIndex = (galleryModalCurrentIndex - 1 + galleryModalSlidesCount) % galleryModalSlidesCount;
            updateGalleryModal();
        });
        
        // 关闭森林宝藏模态框
        galleryCloseBtn.addEventListener('click', function() {
            galleryModal.style.display = 'none';
            
            // 恢复森林宝藏自动轮播
            const carouselContainer = document.querySelector('.carousel-container');
            if (carouselContainer) {
                startAutoPlayForGalleryCarousel(carouselContainer);
            }
        });
        
        // 点击森林宝藏模态框外部关闭
        window.addEventListener('click', function(event) {
            if (event.target === galleryModal) {
                galleryModal.style.display = 'none';
                
                // 恢复森林宝藏自动轮播
                const carouselContainer = document.querySelector('.carousel-container');
                if (carouselContainer) {
                    startAutoPlayForGalleryCarousel(carouselContainer);
                }
            }
        });
        
        // 为森林宝藏轮播启动自动播放的函数
        function startAutoPlayForGalleryCarousel(carouselContainer) {
            const carouselSlides = carouselContainer.querySelectorAll('.carousel-slide');
            const indicators = carouselContainer.querySelectorAll('.indicator');
            let currentIndex = 0;
            const slideCount = carouselSlides.length;
            
            const interval = setInterval(() => {
                currentIndex = (currentIndex + 1) % slideCount;
                
                carouselSlides.forEach((slide, index) => {
                    slide.classList.remove('active');
                    if (index === currentIndex) {
                        slide.classList.add('active');
                    }
                });
                
                indicators.forEach((indicator, index) => {
                    indicator.classList.remove('active');
                    if (index === currentIndex) {
                        indicator.classList.add('active');
                    }
                });
            }, 4000);
            
            carouselContainer.setAttribute('data-interval', interval);
        }
    </script>
</body>
</html>